{"version":3,"file":"EmailsEditor.min.js","sources":["../../../src/emailsEditor.js"],"sourcesContent":["/* eslint-disable no-console */\nimport './main.scss';\n// TODO: turn this into createElement and EXTERNALIZE\nconst REMOVE_SVG = `<svg class=\"remove-icon-svg\" width=\"8\" height=\"8\" viewBox=\"0 0 8 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M8 0.8L7.2 0L4 3.2L0.8 0L0 0.8L3.2 4L0 7.2L0.8 8L4 4.8L7.2 8L8 7.2L4.8 4L8 0.8Z\" fill=\"#050038\"/>\n</svg>`;\n\nexport default class emailsEditor {\n  constructor(config) {\n    config = config || {};\n\n    if (!config || !config.container) {\n      console.log('invalid config exiting...');\n      return;\n    }\n\n    this\n      .initValues(config)\n      .renderMainContainer()\n      .initListeners();\n  }\n\n  destroy() {\n    // todo!\n    // remove listeners\n  }\n\n  initValues(config) {\n    this.emails = {};\n    this.onChange = config.onChange;\n    this.container = config.container;\n    return this;\n  }\n\n  initListeners() {\n    const {container} = this;\n    const input = container.querySelector('input');\n    const ballonsContainer = container.querySelector('.ballons-container');\n    const keys = {\n      ENTER: 13,\n      COMMA: 188,\n    };\n    const keyUpListener = e => {\n      const { keyCode, currentTarget, ctrlKey, metaKey } = e || {};\n      if (keyCode === keys.COMMA || keyCode === keys.ENTER) {\n        this\n          .renderEmails(currentTarget.value)\n          .cleanInput();\n      }\n      if (metaKey || ctrlKey) {\n        return false;\n      }\n      return e;\n    };\n    const pasteListener = e => {\n      const { currentTarget, clipboardData } = e || {};\n      const clipBoardText = clipboardData.getData('text');\n\n      this\n        .renderEmails(currentTarget.value+clipBoardText)\n        .cleanInput();\n\n      e.preventDefault();\n    };\n    input.addEventListener('paste', pasteListener);\n    input.addEventListener('keyup', keyUpListener);\n\n    ballonsContainer.addEventListener('click', (e) => {\n      const isClickOnSvg = e.target.getAttribute('class') === 'remove-icon-svg';\n      const target = isClickOnSvg ? e.target.parentElement : e.target;\n\n      if (target.className === 'remove-icon') {\n        alert(e.target);\n        ballonsContainer.removeChild(target.parentElement);\n      }\n    });\n    return this;\n  }\n\n  renderEmail(string, valid) {\n    const removeIconDiv = document.createElement('div');\n    removeIconDiv.className = !valid ? 'invalid ballon' : 'ballon';\n    // TODO: turn this into createElement\n    removeIconDiv.innerHTML = `${string} <div class=\"remove-icon\">${REMOVE_SVG}</div>`;\n    return removeIconDiv;\n  }\n\n  renderEmails(stringValue) {\n    // eslint-disable-next-line max-len\n    const emailRegx = /(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/g;\n    const blocks = (stringValue || '').split(',');\n    const ballonsBlockFrag = document.createDocumentFragment();\n\n    blocks.map((block) => {\n      if(!(block + '').trim()) {return;}\n      const results = emailRegx.exec(block);\n      ballonsBlockFrag.appendChild(this.renderEmail(block, !!results));\n    });\n\n    const inputEl = this.container.querySelector('.input-container');\n    this.container\n      .querySelector('.ballons-container')\n      .insertBefore(ballonsBlockFrag, inputEl);\n\n    return this;\n  }\n\n  cleanInput() {\n    const {container} = this;\n    const input = container.querySelector('input');\n    input.value = '';\n    return this;\n  }\n\n  renderMainContainer() {\n    const {container} = this;\n    // TODO: turn this to createDocumentFragment later\n    const template = `\n      <div class=\"container\">\n        <div class=\"top\">\n          <h1>Share <strong>Board name</strong> with others</h1>\n          <div class=\"text-container\">\n            <div class=\"ballons-container\">\n              <div class=\"input-container\"><input placeholder=\"add more people...\"/></div>\n            </div>\n          </div>\n        </div>\n        <div class=\"bottom\">\n          <button>\n            Add email\n          </button>  \n          <button>\n            Get emails count\n          </button>\n        </div>\n      </div>\n    `;\n    container.innerHTML = template;\n    return this;\n  }\n}\n"],"names":["config","container","initValues","renderMainContainer","initListeners","emails","onChange","this","input","querySelector","ballonsContainer","keys","addEventListener","e","currentTarget","clipBoardText","clipboardData","getData","_this","renderEmails","value","cleanInput","preventDefault","keyCode","ctrlKey","metaKey","target","getAttribute","parentElement","className","alert","removeChild","string","valid","removeIconDiv","document","createElement","innerHTML","stringValue","emailRegx","blocks","split","ballonsBlockFrag","createDocumentFragment","map","block","trim","results","exec","appendChild","_this2","renderEmail","inputEl","insertBefore"],"mappings":"4OAQcA,0GACVA,EAASA,GAAU,KAEHA,EAAOC,gBAMpBC,WAAWF,GACXG,sBACAC,6GAQMJ,eACJK,OAAS,QACTC,SAAWN,EAAOM,cAClBL,UAAYD,EAAOC,UACjBM,wDAIAN,EAAaM,KAAbN,UACDO,EAAQP,EAAUQ,cAAc,SAChCC,EAAmBT,EAAUQ,cAAc,sBAC3CE,EACG,GADHA,EAEG,WAwBTH,EAAMI,iBAAiB,QAVD,SAAAC,SACqBA,GAAK,GAAtCC,IAAAA,cACFC,IADiBC,cACaC,QAAQ,QAE5CC,EACGC,aAAaL,EAAcM,MAAML,GACjCM,aAEHR,EAAES,mBAGJd,EAAMI,iBAAiB,QAvBD,SAAAC,SACiCA,GAAK,GAAlDU,IAAAA,QAAST,IAAAA,cAAeU,IAAAA,QAASC,IAAAA,eACrCF,IAAYZ,GAAcY,IAAYZ,GACxCO,EACGC,aAAaL,EAAcM,OAC3BC,cAEDI,IAAWD,GAGRX,IAeTH,EAAiBE,iBAAiB,QAAS,SAACC,OAEpCa,EADkD,oBAAnCb,EAAEa,OAAOC,aAAa,SACbd,EAAEa,OAAOE,cAAgBf,EAAEa,OAEhC,gBAArBA,EAAOG,YACTC,MAAMjB,EAAEa,QACRhB,EAAiBqB,YAAYL,EAAOE,kBAGjCrB,yCAGGyB,EAAQC,OACZC,EAAgBC,SAASC,cAAc,cAC7CF,EAAcL,UAAaI,EAA2B,SAAnB,iBAEnCC,EAAcG,oBAAeL,mUACtBE,uCAGII,cAELC,EAAY,sJACZC,GAAUF,GAAe,IAAIG,MAAM,KACnCC,EAAmBP,SAASQ,yBAElCH,EAAOI,IAAI,SAACC,OACLA,EAAQ,IAAIC,YACXC,EAAUR,EAAUS,KAAKH,GAC/BH,EAAiBO,YAAYC,EAAKC,YAAYN,IAASE,WAGnDK,EAAU7C,KAAKN,UAAUQ,cAAc,gCACxCR,UACFQ,cAAc,sBACd4C,aAAaX,EAAkBU,GAE3B7C,iDAIaA,KAAbN,UACiBQ,cAAc,SAChCW,MAAQ,GACPb,0DAIaA,KAAbN,UAsBGoC,2jBACH9B"}