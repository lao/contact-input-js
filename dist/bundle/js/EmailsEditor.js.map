{"version":3,"file":"EmailsEditor.js","sources":["../../../src/emailsEditor.js"],"sourcesContent":["/* eslint-disable no-console */\nimport './main.scss';\n// TODO: turn this into createElement and EXTERNALIZE\nconst REMOVE_SVG = `<svg class=\"remove-icon-svg\" width=\"8\" height=\"8\" viewBox=\"0 0 8 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M8 0.8L7.2 0L4 3.2L0.8 0L0 0.8L3.2 4L0 7.2L0.8 8L4 4.8L7.2 8L8 7.2L4.8 4L8 0.8Z\" fill=\"#050038\"/>\n</svg>`;\n\nexport default class emailsEditor {\n  constructor(config) {\n    config = config || {};\n\n    if (!config || !config.container) {\n      console.log('invalid config exiting...');\n      return;\n    }\n\n    this\n      .initValues(config)\n      .renderMainContainer()\n      .initListeners();\n  }\n\n  destroy() {\n    // todo!\n    // remove listeners\n  }\n\n  initValues(config) {\n    this.emails = {};\n    this.onChange = config.onChange;\n    this.container = config.container;\n    return this;\n  }\n\n  initListeners() {\n    const {container} = this;\n    const input = container.querySelector('input');\n    const ballonsContainer = container.querySelector('.ballons-container');\n    const keys = {\n      ENTER: 13,\n      COMMA: 188,\n    };\n    const keyUpListener = e => {\n      const { keyCode, currentTarget, ctrlKey, metaKey } = e || {};\n      if (keyCode === keys.COMMA || keyCode === keys.ENTER) {\n        this\n          .renderEmails(currentTarget.value)\n          .cleanInput();\n      }\n      if (metaKey || ctrlKey) {\n        return false;\n      }\n      return e;\n    };\n    const pasteListener = e => {\n      const { currentTarget, clipboardData } = e || {};\n      const clipBoardText = clipboardData.getData('text');\n\n      this\n        .renderEmails(currentTarget.value+clipBoardText)\n        .cleanInput();\n\n      e.preventDefault();\n    };\n    input.addEventListener('paste', pasteListener);\n    input.addEventListener('keyup', keyUpListener);\n\n    ballonsContainer.addEventListener('click', (e) => {\n      const isClickOnSvg = e.target.getAttribute('class') === 'remove-icon-svg';\n      const target = isClickOnSvg ? e.target.parentElement : e.target;\n\n      if (target.className === 'remove-icon') {\n        alert(e.target);\n        ballonsContainer.removeChild(target.parentElement);\n      }\n    });\n    return this;\n  }\n\n  renderEmail(string, valid) {\n    const removeIconDiv = document.createElement('div');\n    removeIconDiv.className = !valid ? 'invalid ballon' : 'ballon';\n    // TODO: turn this into createElement\n    removeIconDiv.innerHTML = `${string} <div class=\"remove-icon\">${REMOVE_SVG}</div>`;\n    return removeIconDiv;\n  }\n\n  renderEmails(stringValue) {\n    // eslint-disable-next-line max-len\n    const emailRegx = /(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))/g;\n    const blocks = (stringValue || '').split(',');\n    const ballonsBlockFrag = document.createDocumentFragment();\n\n    blocks.map((block) => {\n      if(!(block + '').trim()) {return;}\n      const results = emailRegx.exec(block);\n      ballonsBlockFrag.appendChild(this.renderEmail(block, !!results));\n    });\n\n    const inputEl = this.container.querySelector('.input-container');\n    this.container\n      .querySelector('.ballons-container')\n      .insertBefore(ballonsBlockFrag, inputEl);\n\n    return this;\n  }\n\n  cleanInput() {\n    const {container} = this;\n    const input = container.querySelector('input');\n    input.value = '';\n    return this;\n  }\n\n  renderMainContainer() {\n    const {container} = this;\n    // TODO: turn this to createDocumentFragment later\n    const template = `\n      <div class=\"container\">\n        <div class=\"top\">\n          <h1>Share <strong>Board name</strong> with others</h1>\n          <div class=\"text-container\">\n            <div class=\"ballons-container\">\n              <div class=\"input-container\"><input placeholder=\"add more people...\"/></div>\n            </div>\n          </div>\n        </div>\n        <div class=\"bottom\">\n          <button>\n            Add email\n          </button>  \n          <button>\n            Get emails count\n          </button>\n        </div>\n      </div>\n    `;\n    container.innerHTML = template;\n    return this;\n  }\n}\n"],"names":["REMOVE_SVG","emailsEditor","config","container","console","log","initValues","renderMainContainer","initListeners","emails","onChange","input","querySelector","ballonsContainer","keys","ENTER","COMMA","keyUpListener","e","keyCode","currentTarget","ctrlKey","metaKey","renderEmails","value","cleanInput","pasteListener","clipboardData","clipBoardText","getData","preventDefault","addEventListener","isClickOnSvg","target","getAttribute","parentElement","className","alert","removeChild","string","valid","removeIconDiv","document","createElement","innerHTML","stringValue","emailRegx","blocks","split","ballonsBlockFrag","createDocumentFragment","map","block","trim","results","exec","appendChild","renderEmail","inputEl","insertBefore","template"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;EAGA,IAAMA,UAAU,wSAAhB;MAIqBC;;EACnB,wBAAYC,MAAZ,EAAoB;EAAA;EAClBA,IAAAA,MAAM,GAAGA,MAAM,IAAI,EAAnB;EAEA,QAAI,CAACA,MAAD,IAAW,CAACA,MAAM,CAACC,SAAvB,EAAkC;EAChCC,MAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;EACA;EACD;EAED,SACGC,UADH,CACcJ,MADd,EAEGK,mBAFH,GAGGC,aAHH;EAID;;;gCAES;EAGT;;;iCAEUN,QAAQ;EACjB,WAAKO,MAAL,GAAc,EAAd;EACA,WAAKC,QAAL,GAAgBR,MAAM,CAACQ,QAAvB;EACA,WAAKP,SAAL,GAAiBD,MAAM,CAACC,SAAxB;EACA,aAAO,IAAP;EACD;;;sCAEe;EAAA;EAAA,UACPA,SADO,GACM,IADN,CACPA,SADO;EAEd,UAAMQ,KAAK,GAAGR,SAAS,CAACS,aAAV,CAAwB,OAAxB,CAAd;EACA,UAAMC,gBAAgB,GAAGV,SAAS,CAACS,aAAV,CAAwB,oBAAxB,CAAzB;EACA,UAAME,IAAI,GAAG;EACXC,QAAAA,KAAK,EAAE,EADI;EAEXC,QAAAA,KAAK,EAAE;EAFI,OAAb;EAIA,UAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAAC,CAAC,EAAI;EAAA,mBAC4BA,CAAC,IAAI,EADjC;EAAA,YACjBC,OADiB,QACjBA,OADiB;EAAA,YACRC,aADQ,QACRA,aADQ;EAAA,YACOC,OADP,QACOA,OADP;EAAA,YACgBC,OADhB,QACgBA,OADhB;EAEzB,YAAIH,OAAO,KAAKL,IAAI,CAACE,KAAjB,IAA0BG,OAAO,KAAKL,IAAI,CAACC,KAA/C,EAAsD;EACpD,UAAA,KAAI,CACDQ,YADH,CACgBH,aAAa,CAACI,KAD9B,EAEGC,UAFH;EAGD;EACD,YAAIH,OAAO,IAAID,OAAf,EAAwB;EACtB,iBAAO,KAAP;EACD;EACD,eAAOH,CAAP;EACD,OAXD;EAYA,UAAMQ,aAAa,GAAG,SAAhBA,aAAgB,CAAAR,CAAC,EAAI;EAAA,oBACgBA,CAAC,IAAI,EADrB;EAAA,YACjBE,aADiB,SACjBA,aADiB;EAAA,YACFO,aADE,SACFA,aADE;EAEzB,YAAMC,aAAa,GAAGD,aAAa,CAACE,OAAd,CAAsB,MAAtB,CAAtB;EAEA,QAAA,KAAI,CACDN,YADH,CACgBH,aAAa,CAACI,KAAd,GAAoBI,aADpC,EAEGH,UAFH;EAIAP,QAAAA,CAAC,CAACY,cAAF;EACD,OATD;EAUAnB,MAAAA,KAAK,CAACoB,gBAAN,CAAuB,OAAvB,EAAgCL,aAAhC;EACAf,MAAAA,KAAK,CAACoB,gBAAN,CAAuB,OAAvB,EAAgCd,aAAhC;EAEAJ,MAAAA,gBAAgB,CAACkB,gBAAjB,CAAkC,OAAlC,EAA2C,UAACb,CAAD,EAAO;EAChD,YAAMc,YAAY,GAAGd,CAAC,CAACe,MAAF,CAASC,YAAT,CAAsB,OAAtB,MAAmC,iBAAxD;EACA,YAAMD,MAAM,GAAGD,YAAY,GAAGd,CAAC,CAACe,MAAF,CAASE,aAAZ,GAA4BjB,CAAC,CAACe,MAAzD;EAEA,YAAIA,MAAM,CAACG,SAAP,KAAqB,aAAzB,EAAwC;EACtCC,UAAAA,KAAK,CAACnB,CAAC,CAACe,MAAH,CAAL;EACApB,UAAAA,gBAAgB,CAACyB,WAAjB,CAA6BL,MAAM,CAACE,aAApC;EACD;EACF,OARD;EASA,aAAO,IAAP;EACD;;;kCAEWI,QAAQC,OAAO;EACzB,UAAMC,aAAa,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAtB;EACAF,MAAAA,aAAa,CAACL,SAAd,GAA0B,CAACI,KAAD,GAAS,gBAAT,GAA4B,QAAtD,CAFyB;EAIzBC,MAAAA,aAAa,CAACG,SAAd,aAA6BL,MAA7B,yCAAgEvC,UAAhE;EACA,aAAOyC,aAAP;EACD;;;mCAEYI,aAAa;EAAA;EAExB,UAAMC,SAAS,GAAG,qJAAlB;EACA,UAAMC,MAAM,GAAG,CAACF,WAAW,IAAI,EAAhB,EAAoBG,KAApB,CAA0B,GAA1B,CAAf;EACA,UAAMC,gBAAgB,GAAGP,QAAQ,CAACQ,sBAAT,EAAzB;EAEAH,MAAAA,MAAM,CAACI,GAAP,CAAW,UAACC,KAAD,EAAW;EACpB,YAAG,CAAC,CAACA,KAAK,GAAG,EAAT,EAAaC,IAAb,EAAJ,EAAyB;EAAC;EAAQ;EAClC,YAAMC,OAAO,GAAGR,SAAS,CAACS,IAAV,CAAeH,KAAf,CAAhB;EACAH,QAAAA,gBAAgB,CAACO,WAAjB,CAA6B,MAAI,CAACC,WAAL,CAAiBL,KAAjB,EAAwB,CAAC,CAACE,OAA1B,CAA7B;EACD,OAJD;EAMA,UAAMI,OAAO,GAAG,KAAKvD,SAAL,CAAeS,aAAf,CAA6B,kBAA7B,CAAhB;EACA,WAAKT,SAAL,CACGS,aADH,CACiB,oBADjB,EAEG+C,YAFH,CAEgBV,gBAFhB,EAEkCS,OAFlC;EAIA,aAAO,IAAP;EACD;;;mCAEY;EAAA,UACJvD,SADI,GACS,IADT,CACJA,SADI;EAEX,UAAMQ,KAAK,GAAGR,SAAS,CAACS,aAAV,CAAwB,OAAxB,CAAd;EACAD,MAAAA,KAAK,CAACa,KAAN,GAAc,EAAd;EACA,aAAO,IAAP;EACD;;;4CAEqB;EAAA,UACbrB,SADa,GACA,IADA,CACbA,SADa;EAGpB,UAAMyD,QAAQ,ikBAAd;EAoBAzD,MAAAA,SAAS,CAACyC,SAAV,GAAsBgB,QAAtB;EACA,aAAO,IAAP;EACD;;;;;;;;;;;"}